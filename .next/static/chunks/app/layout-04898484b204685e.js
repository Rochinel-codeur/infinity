(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2855:function(e,t,n){Promise.resolve().then(n.t.bind(n,7960,23)),Promise.resolve().then(n.bind(n,7202)),Promise.resolve().then(n.bind(n,4339))},7202:function(e,t,n){"use strict";n.d(t,{PushNotificationManager:function(){return s}});var i=n(7437),r=n(2265);function s(){let[e,t]=(0,r.useState)(!1),[n,s]=(0,r.useState)(!1);(0,r.useEffect)(()=>{"serviceWorker"in navigator&&"PushManager"in window&&navigator.serviceWorker.register("/sw.js").then(function(e){e.pushManager.getSubscription().then(function(e){e?t(!0):setTimeout(()=>{s(!0)},5e3)})},function(e){console.error("Service Worker registration failed:",e)})},[]);let o=async()=>{if("serviceWorker"in navigator)try{let e=await navigator.serviceWorker.ready,n="BKdhIQDE0NtewKnNAnly7Fqp6nfYfADi8I8LCwCvEqtObhI3BjxmA_VGgXntiCTrMKHbXcsuBiFy63-Jd8denws";if(!n){alert("Erreur de configuration : Cl\xe9 VAPID manquante. Contactez l'admin.");return}let i=function(e){let t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(n),r=new Uint8Array(i.length);for(let e=0;e<i.length;++e)r[e]=i.charCodeAt(e);return r}(n),r=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i});await fetch("/api/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),t(!0),s(!1),alert("\uD83D\uDD14 Notifications activ\xe9es ! Vous recevrez nos meilleures astuces.")}catch(e){console.error("Failed to subscribe the user: ",e),alert("Impossible d'activer. V\xe9rifiez si vous \xeates en navigation priv\xe9e ou si vous avez bloqu\xe9 les notifications.")}};return!n||e?null:(0,i.jsx)("div",{className:"fixed bottom-4 right-4 z-[9999] flex justify-center px-4 animate-bounce-in",children:(0,i.jsxs)("div",{className:"bg-zinc-900 border border-indigo-500/50 p-4 rounded-xl shadow-2xl max-w-sm w-full flex items-start gap-4 backdrop-blur-md cursor-default text-left",children:[(0,i.jsx)("div",{className:"bg-indigo-600/20 p-2 rounded-full text-indigo-400",children:(0,i.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"font-bold text-white text-sm",children:"Ne manquez aucun gain !"}),(0,i.jsx)("p",{className:"text-zinc-400 text-xs mt-1",children:"Activez les notifications pour recevoir les coupons valid\xe9s en temps r\xe9el."}),(0,i.jsxs)("div",{className:"flex gap-3 mt-3",children:[(0,i.jsx)("button",{onClick:o,className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-3 py-1.5 rounded-lg transition-colors",children:"Activer"}),(0,i.jsx)("button",{onClick:()=>s(!1),className:"text-zinc-500 hover:text-white text-xs px-2 py-1.5",children:"Plus tard"})]})]})]})})}},4339:function(e,t,n){"use strict";n.d(t,{TrackingProvider:function(){return s}});var i=n(7437),r=n(2265);function s(e){let{children:t}=e;return!function(){let e=(0,r.useRef)("");(0,r.useEffect)(()=>{e.current=function(){let e=sessionStorage.getItem("tracking_session_id");if(e)return e;let t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11));return sessionStorage.setItem("tracking_session_id",t),t}(),t("page_view")},[]);let t=async(t,n)=>{try{await fetch("/api/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:t,sessionId:e.current,metadata:n})})}catch(e){console.debug("Tracking error:",e)}}}(),(0,i.jsx)(i.Fragment,{children:t})}},7960:function(){}},function(e){e.O(0,[587,971,117,744],function(){return e(e.s=2855)}),_N_E=e.O()}]);